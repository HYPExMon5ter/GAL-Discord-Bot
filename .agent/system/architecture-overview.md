# Guardian Angel League Bot - Architecture Overview

**Last Updated:** 2025-10-10  
**Status:** Production Ready with Live Graphics Removed

## ğŸ—ï¸ System Architecture

### Core Components
- **Discord Bot (`bot.py`)**: Modern Discord.py v2 implementation with slash commands
- **Command System (`core/commands.py`)**: Tournament management, registration, check-in
- **Configuration (`config.py`, `config.yaml`)**: YAML-based with environment validation
- **Persistence Layer**: PostgreSQL with SQLite fallback, connection pooling
- **Integration Framework**: Modular system for external services

### Current Integrations
- âœ… **Google Sheets**: Registration data, smart caching (10min refresh)
- âœ… **Riot API**: Player verification and statistics
- âœ… **OBS WebSocket**: Live streaming integration
- âŒ **Live Graphics Dashboard**: **REMOVED** (deleted 2025-10-10)

### Data Flow
```
Discord Commands â†’ Core Logic â†’ External APIs â†’ Database â†’ Discord UI
     â†“                â†“              â†“           â†“         â†“
Slash Commands â†’ Business Logic â†’ Sheets/Riot â†’ Cache â†’ Embeds/Views
```

## ğŸ“Š Current Health Status

### âœ… Working Systems
- Tournament registration and check-in
- Team management (normal/double-up modes)
- Onboarding system with approval workflow
- Waitlist management
- Role synchronization
- Background caching tasks
- Error handling and logging

### âš ï¸ Issues Identified
- **Live Graphics Dashboard**: Completely removed from codebase
- **Database Files**: Missing `data/graphics.db` and related image assets
- **Security**: Discord tokens visible in logs (needs masking)
- **Dependencies**: Heavy ML packages not utilized (chromadb, langchain)

### ğŸš¨ Security Concerns
- Discord tokens exposed in log files
- Missing input validation on some endpoints
- No rate limiting on external API calls

## ğŸ“ˆ Performance Metrics
- **Dependencies**: 200+ packages (needs cleanup)
- **Log Size**: 20MB (healthy activity)
- **Cache Hit Rate**: High (effective Google Sheets caching)
- **Memory Usage**: Moderate (asyncio-based architecture)

## ğŸ”§ Optimization Recommendations

### High Priority
1. **Security**: Implement token masking in logs
2. **Dependencies**: Remove unused ML/AI packages
3. **Live Graphics**: Restore or replace deleted dashboard
4. **Database**: Recover missing graphics.db

### Medium Priority
1. **Testing**: Expand beyond basic component tests
2. **Monitoring**: Add health check endpoints
3. **Documentation**: Update for current architecture
4. **API Rate Limiting**: Implement proper throttling

## ğŸ¯ Next Steps
1. Address immediate security concerns
2. Restore live graphics functionality
3. Clean up dependency bloat
4. Improve test coverage
5. Consider migration to managed database

## ğŸ“ Recent Changes (2025-10-10)
- **REMOVED**: Entire live-graphics-dashboard directory
- **MODIFIED**: Core bot functionality for standalone operation
- **ADDED**: New integrations for OBS and sheet optimization
- **UPDATED**: Requirements and configuration management

---
**Generated by:** Full-Cycle System Analysis  
**Review Date:** 2025-10-10
